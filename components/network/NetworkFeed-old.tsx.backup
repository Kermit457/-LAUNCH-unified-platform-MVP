"use client"

import { motion } from 'framer-motion'
import { Zap, UserPlus, Users, Briefcase, Award, TrendingUp, ThumbsUp, MessageCircle } from 'lucide-react'

type NetworkEventType =
  | 'connect_created'
  | 'invite_sent'
  | 'invite_accepted'
  | 'collab_opened'
  | 'collab_filled'
  | 'task_posted'
  | 'task_claimed'
  | 'referral_converted'

interface NetworkEvent {
  id: string
  type: NetworkEventType
  actor: string
  target?: string
  metadata?: {
    projectName?: string
    taskTitle?: string
    reward?: string
    role?: string
  }
  timestamp: string
  reactions: number
}

const mockEvents: NetworkEvent[] = [
  {
    id: '1',
    type: 'collab_filled',
    actor: 'crypto_mike',
    metadata: { projectName: 'DeFi Protocol', role: 'Rust Dev' },
    timestamp: '2m ago',
    reactions: 12
  },
  {
    id: '2',
    type: 'invite_accepted',
    actor: 'sarah_dev',
    target: 'alex_builder',
    timestamp: '5m ago',
    reactions: 8
  },
  {
    id: '3',
    type: 'task_posted',
    actor: 'degen_trader',
    metadata: { taskTitle: 'UI/UX for NFT marketplace', reward: '$800' },
    timestamp: '12m ago',
    reactions: 5
  },
  {
    id: '4',
    type: 'connect_created',
    actor: 'meme_master',
    target: 'scout_anna',
    timestamp: '18m ago',
    reactions: 3
  },
  {
    id: '5',
    type: 'task_claimed',
    actor: 'alex_builder',
    metadata: { taskTitle: 'Smart contract audit', reward: '$2,000' },
    timestamp: '25m ago',
    reactions: 15
  },
  {
    id: '6',
    type: 'referral_converted',
    actor: 'crypto_mike',
    target: 'new_builder_42',
    timestamp: '32m ago',
    reactions: 6
  },
  {
    id: '7',
    type: 'collab_opened',
    actor: 'sarah_dev',
    metadata: { projectName: 'Meme Coin Launcher', role: 'Frontend Dev' },
    timestamp: '45m ago',
    reactions: 9
  },
  {
    id: '8',
    type: 'invite_sent',
    actor: 'scout_anna',
    target: 'potential_whale',
    timestamp: '1h ago',
    reactions: 2
  }
]

const eventConfig: Record<NetworkEventType, { icon: typeof Zap, color: string, format: (event: NetworkEvent) => string }> = {
  connect_created: {
    icon: Users,
    color: 'text-[#00FFFF]',
    format: (e) => `${e.actor} connected with ${e.target}`
  },
  invite_sent: {
    icon: UserPlus,
    color: 'text-[#8800FF]',
    format: (e) => `${e.actor} invited ${e.target}`
  },
  invite_accepted: {
    icon: UserPlus,
    color: 'text-[#00FF88]',
    format: (e) => `${e.actor} accepted invite from ${e.target}`
  },
  collab_opened: {
    icon: Briefcase,
    color: 'text-[#FFD700]',
    format: (e) => `${e.actor} opened collab: ${e.metadata?.projectName} (${e.metadata?.role})`
  },
  collab_filled: {
    icon: Award,
    color: 'text-[#00FF88]',
    format: (e) => `${e.actor} filled role: ${e.metadata?.role} in ${e.metadata?.projectName}`
  },
  task_posted: {
    icon: Briefcase,
    color: 'text-[#FF8800]',
    format: (e) => `${e.actor} posted task: ${e.metadata?.taskTitle} (${e.metadata?.reward})`
  },
  task_claimed: {
    icon: Zap,
    color: 'text-[#00FFFF]',
    format: (e) => `${e.actor} claimed: ${e.metadata?.taskTitle} (${e.metadata?.reward})`
  },
  referral_converted: {
    icon: TrendingUp,
    color: 'text-[#8800FF]',
    format: (e) => `${e.actor}'s referral ${e.target} activated their curve`
  }
}

export function NetworkFeed() {
  const handleReact = (eventId: string) => {
    console.log('React to event:', eventId)
    // TODO: Implement reaction logic (boost rank)
  }

  const handleComment = (eventId: string) => {
    console.log('Comment on event:', eventId)
    // TODO: Implement comment logic
  }

  return (
    <div className="p-4 rounded-xl bg-zinc-900/30 border border-zinc-800">
      <div className="flex items-center justify-between mb-4">
        <h2 className="text-lg font-bold text-white flex items-center gap-2">
          <Zap className="w-5 h-5 text-[#00FFFF]" />
          Network Moves
        </h2>
        <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse" title="Live" />
      </div>

      <p className="text-sm text-zinc-400 mb-4">
        Real-time activity. React to boost rank.
      </p>

      <div className="space-y-3 max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-zinc-700 scrollbar-track-zinc-900">
        {mockEvents.map((event, index) => {
          const config = eventConfig[event.type]
          const Icon = config.icon

          return (
            <motion.div
              key={event.id}
              initial={{ opacity: 0, x: 20 }}
              animate={{ opacity: 1, x: 0 }}
              transition={{ delay: index * 0.05 }}
              className="p-3 rounded-lg bg-zinc-800/50 border border-zinc-700 hover:border-zinc-600 transition-all"
            >
              {/* Event Content */}
              <div className="flex items-start gap-2 mb-2">
                <div className={`w-8 h-8 rounded-lg bg-zinc-700/50 flex items-center justify-center flex-shrink-0 ${config.color}`}>
                  <Icon className="w-4 h-4" />
                </div>
                <div className="flex-1 min-w-0">
                  <p className="text-xs text-zinc-300 leading-relaxed">
                    {config.format(event)}
                  </p>
                  <span className="text-[10px] text-zinc-500">{event.timestamp}</span>
                </div>
              </div>

              {/* Actions */}
              <div className="flex items-center gap-3 pl-10">
                <button
                  onClick={() => handleReact(event.id)}
                  className="flex items-center gap-1 text-zinc-400 hover:text-[#00FF88] transition-colors text-xs"
                >
                  <ThumbsUp className="w-3 h-3" />
                  <span>{event.reactions}</span>
                </button>
                <button
                  onClick={() => handleComment(event.id)}
                  className="flex items-center gap-1 text-zinc-400 hover:text-[#00FFFF] transition-colors text-xs"
                >
                  <MessageCircle className="w-3 h-3" />
                </button>
              </div>
            </motion.div>
          )
        })}
      </div>

      {/* Empty State (when no events) */}
      {mockEvents.length === 0 && (
        <div className="py-8 text-center">
          <Zap className="w-12 h-12 text-zinc-700 mx-auto mb-3" />
          <p className="text-sm text-zinc-500">No activity yet. Be the first to move.</p>
        </div>
      )}
    </div>
  )
}
